/*
 Hype Reactive Content 1.5.0
copyright (c) 2024 Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeReactiveContent"in window&&(window.HypeReactiveContent=function(){function C(a){g("trackRedraws")&&requestAnimationFrame(()=>{if(a.isConnected){var d=a.getBoundingClientRect();if(0!==d.width||0!==d.height){var b=document.createElement("div");b.className="hype-reactive-redraw-overlay";b.style.position="absolute";b.style.pointerEvents="none";b.style.zIndex="9999";b.style.boxSizing="border-box";b.style.backgroundColor=g("redrawOverlayColor");b.style.border=`${g("redrawBorderWidth")} solid ${g("redrawBorderColor")}`;
b.style.top=window.scrollY+d.top+"px";b.style.left=window.scrollX+d.left+"px";b.style.width=d.width+"px";b.style.height=d.height+"px";document.body.appendChild(b);setTimeout(()=>{b&&b.parentNode&&b.parentNode.removeChild(b)},g("redrawHighlightDuration"))}}})}function g(a){return a?u[a]:u}function y(a,d){return a?a+"."+d:d}function z(a,d,b){b=b||"";return null==a||a[A]?a:new Proxy(a,{get:function(e,k,c){if("_key"===k)return b;if(k===A)return!0;e=Reflect.get(e,k,c);return"object"===typeof e?z(e,d,y(b,
k)):e},set:function(e,k,c,f){const l=Reflect.set(e,k,c,f);d(k,c,e,f);return l}})}function D(a){if(!a[A])return a;const d={};for(const b in a)if(a.hasOwnProperty(b)){const e=a[b];d[b]="object"===typeof e?D(e):e}return d}function B(a){return function(){if(!a.timeout){var d=arguments;a.timeout=requestAnimationFrame(function(){a.apply(this,d);a.timeout=null}.bind(this))}}}function t(a,d,b,e){if(b){if("object"!==typeof b)return null}else{if(void 0===b)return null;b=d.customData}e=e||{};if(!1!=="HypeActionEvents"in
window)return d.triggerAction(a,{element:e.element,event:{type:e.type},scope:b});try{let k=new Proxy(Object.assign({element:e.element,$elm:e.element},d),{set(c,f,l,n){return Reflect.get(c,f,n)?Reflect.set(c,f,l,n):Reflect.set(b,f,l)},get(c,f,l){return(c=Reflect.get(c,f,l))?c:Reflect.get(b,f)},has(c,f,l){return c.hasOwnProperty(f)||window[f]?Reflect.has(c,f,l):!0}});return(new Function("$context","with($context){ "+a+"}"))(k)}catch(k){g("debug")||-1!=window.location.href.indexOf("127.0.0.1:")&&-1!=
window.location.href.indexOf("/preview/")?console.error("%c"+(e.errorMsg||"HypeReactiveContent Error")+"%c"+(e.errorMsg?"":" version "+HypeReactiveContent.version)+"\n\n%c"+a+(e.omitError?"":"%c\n\n"+k+"\n\n"),"font-size:12px; font-weight:bold","font-size:8px","min-height:40px;display: inline-block; padding: 10px; background-color: rgba(255,255,255,0.25); border: 1px solid lightgray; border-radius: 4px; font-family:Monospace; font-size:12px","font-size:11px",e.element?e.element:""):console.error(k)}}
function E(a,d,b){return b?t("return "+b,a,null,{element:d,type:"HypeReactiveScope"}):null}function F(a,d){let b=d.closest("[data-scope]");return b?E(a,d,b.getAttribute("data-scope")):null}function w(a,d,b){const e=g("scopeSymbol"),k=e.length;let c=null;a=a.trim();a.startsWith(e)?(a=a.slice(k),c=F(d,b)):a.includes(e)&&(c=a.slice(0,a.indexOf(e)),c=E(d,b,c),a=a.slice(a.indexOf(e)+k));return{value:a,scope:c}}function H(a,d,b){return a.replace(/{{\s*([^{}\s]+)\s*}}/g,function(e,k){e=w(k,d,b);e=t("return "+
e.value,d,e.scope,{element:b,type:"HypeReactiveTemplate"});return void 0!==e?e:""})}function I(a){let d=document.getElementById(a.currentSceneId()),b=r.get(a)||new Map;d.querySelectorAll("[data-content-template]").forEach(function(e){const k=e.getAttribute("data-content-template"),c=e.innerHTML;k&&!b.has(k)?b.set(k,c):k||b.has(e)||b.set(e,c)});r.set(a,b)}function J(a){x.set(a,a.customData||{});Object.defineProperty(a,"customData",{get:function(){return x.get(a)},set:function(d){d=z(d,a.refreshReactiveContentDebounced);
x.set(a,d);g("debounceCustomDataUpdate")?a.refreshReactiveContentDebounced():a.refreshReactiveContent()}})}function K(a,d,b){!1==="HypeActionEvents"in window&&(d=b.customBehaviorName,"#"!=d.charAt(0)&&/[;=()]/.test(d)&&t(d,a,a.customData))}const G=-1!=window.location.href.indexOf("/Hype/Scratch/HypeScratch."),x=new WeakMap;let u={scopeSymbol:"\u21e2",visibilitySymbol:"\ud83d\udc41\ufe0f",effectSymbol:"\u26a1\ufe0f",templateSymbol:"\ud83d\udcdd",debounceCustomDataUpdate:!0,visibilityMode:"auto",debug:!1,
trackRedraws:!1,redrawHighlightDuration:250,redrawOverlayColor:"rgba(255, 0, 0, 0.2)",redrawBorderColor:"rgba(255, 0, 0, 0.5)",redrawBorderWidth:"1px"};G&&(u=Object.assign(u,{highlightReactiveContent:!0,highlightVisibilityData:!0,highlightVisibilityArea:!0,highlightActionData:!0,highlightScopeData:!0,highlightTemplateData:!0}));let A=Symbol("isProxy");const r=new WeakMap;!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,
d,b){function e(c,f,l,n,h){(n=c.closest("["+l+"-action]"))&&t(n.getAttribute(l+"-action"),a,null,{element:c,type:f});if((n=c.closest("["+l+"-behavior]"))&&!k[n.id]){k[n.id]=!0;let m=n.getAttribute(l+"-behavior");B(function(){a.triggerCustomBehaviorNamed(m)})()}}let k={};a.refreshReactiveContent=function(c,f,l,n){void 0===c||void 0===f||/[;=()]/.test(f)||a.triggerCustomBehaviorNamed(y(n._key,c)+" equals "+("string"===typeof f?'"'+f+'"':f));void 0!==c&&(g("customDataUpdate")&&g("customDataUpdate")(c,
f,l,n),a.customDataUpdate&&a.customDataUpdate(c,f,l,n),a.triggerCustomBehaviorNamed("customData was changed"),a.triggerCustomBehaviorNamed(y(n._key,c)+" was updated"));f=document.getElementById(a.currentSceneId());k={};f.querySelectorAll("[data-visibility], [data-content], [data-effect], [data-content-template]").forEach(function(h){var m=h.getAttribute("data-content"),q=h.getAttribute("data-visibility"),v=h.getAttribute("data-effect"),p=h.hasAttribute("data-content-template");q&&(q=w(q,a,h),q=t("return "+
q.value,a,q.scope,{element:h,type:"HypeReactiveVisibility"}),"none"==h.style.display&&(h.style.display="block"),q=q?"visible":"hidden",q!==h.style.visibility&&(h.style.visibility=q,c&&e(h,"HypeReactiveVisibilityChanged","data-visibility-changed",!0,!0)));v&&(v=w(v,a,h),t(v.value,a,v.scope,{element:h,type:"HypeReactiveEffect"}));m?(m=w(m,a,h),p=t("return "+m.value,a,m.scope,{element:h,type:"HypeReactiveContent"}),null!==p&&(p=void 0!==p?p:"",m=document.createElement("div"),m.innerHTML=p,m=m.innerHTML,
m!==h.innerHTML&&(h.innerHTML=m,C(h),c&&e(h,"HypeReactiveContentChanged","data-content-changed",!0,!0)))):p&&(m=h.getAttribute("data-content-template"),p=r.get(a)||new Map,(m=m?p.get(m):p.get(h))?(m=H(m,a,h),p=document.createElement("div"),p.innerHTML=m,m=p.innerHTML,m!==h.innerHTML&&(h.innerHTML=m,C(h),c&&e(h,"HypeReactiveTemplateChanged","data-content-template-changed",!0,!0))):h.innerHTML="")});!1!=="HypeDataMagic"in window&&HypeDataMagic.getDefault("refreshOnCustomData")&&a.refresh()};a.refreshReactiveContentDebounced=
B(a.refreshReactiveContent);a.resolveClosestScope=function(c){return F(a,c)};a.enableReactiveCustomData=function(c){const f=x.get(a)||{};a.customData=Object.assign(f,c||{})};a.setContentTemplateByName=function(c,f,l=!0){let n=r.get(a)||new Map;n.set(c,f);r.set(a,n);l&&a.refreshReactiveContentDebounced()};a.setContentTemplates=function(c,f=!0){if(c&&"object"===typeof c){for(let l in c)c.hasOwnProperty(l)&&a.setContentTemplateByName(l,c[l],!1);f&&a.refreshReactiveContentDebounced()}};a.flushContentTemplateByName=
function(c,f=!0){const l=r.get(a);l&&c&&(l.delete(c),r.set(a,l),f&&a.refreshReactiveContentDebounced())};a.flushContentTemplates=function(c=!0){const f=r.get(a);f&&(f.clear(),r.set(a,f),c&&a.refreshReactiveContentDebounced())};J(a);a.enableReactiveCustomData(g("customData")||{});a.functions().HypeReactiveContent&&a.functions().HypeReactiveContent(a,d,b)}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,d,b){I(a);a.refreshReactiveContent()}});!1==="HypeActionEvents"in
window&&window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",callback:K});G?window.addEventListener("DOMContentLoaded",function(a){g("highlightReactiveContent")&&(a=["[data-scope] [data-content*\x3d"+g("scopeSymbol")+"],[data-scope] [data-effect*\x3d"+g("scopeSymbol")+"],[data-scope] [data-visibility*\x3d"+g("scopeSymbol")+"]{--data-reactive-color: #ffcccc}","[data-content], [data-effect], [data-visibility], [data-content-template]{--data-reactive-color: #f8d54f}"],document.documentElement.style.setProperty("--data-reactive-color",
"#f8d54f"),g("highlightActionData")&&(a=a.concat(["[data-content]{outline:1px dashed var(--data-reactive-color);position:relative}","[data-content]::before{content:attr(data-content);font-family:Helvetica,Arial;line-height:11px;font-size:9px;font-weight:normal;padding:2px 5px;white-space:nowrap;max-height:16px;color:#000;text-align:center;background-color:var(--data-reactive-color);position:absolute;top:-15px;left:-1px;border-top-right-radius:.2rem;border-top-left-radius:.2rem;}","[data-effect]::before{content:'"+
g("effectSymbol")+" ' attr(data-effect);font-family:Helvetica,Arial;line-height:11px;font-size:9px;font-weight:normal;padding:2px 5px;white-space:nowrap;max-height:16px;color:#000;text-align:center;background-color:var(--data-reactive-color);position:absolute;top:-15px;left:-1px;border-top-right-radius:.2rem;border-top-left-radius:.2rem;}","[data-content][data-effect]::before{content: attr(data-content) ' "+g("effectSymbol")+" ' attr(data-effect)}"])),g("highlightTemplateData")&&(a=a.concat(["[data-content-template]{outline:1px dashed var(--data-reactive-color);position:relative}",
"[data-content-template]::before{content:'"+g("templateSymbol")+" ' attr(data-content-template);font-family:Helvetica,Arial;line-height:11px;font-size:9px;font-weight:normal;padding:2px 5px;white-space:nowrap;max-height:16px;color:#000;text-align:center;background-color:var(--data-reactive-color);position:absolute;top:-15px;left:-1px;border-top-right-radius:.2rem;border-top-left-radius:.2rem;}"])),g("highlightVisibilityData")&&(a=a.concat(["[data-visibility]::before{content:'"+g("visibilitySymbol")+
" ' attr(data-visibility);font-family:Helvetica,Arial;line-height:11px;font-size:9px;font-weight:normal;padding:2px 5px;white-space:nowrap;max-height:16px;color:#000;text-align:center;background-color:var(--data-reactive-color);position:absolute;top:-15px;left:-1px;border-top-right-radius:.2rem;border-top-left-radius:.2rem;}"])),g("highlightScopeData")&&(a=a.concat(["[data-scope]{--data-reactive-color:#ffcccc; outline:1px dashed var(--data-reactive-color);}","[data-scope]::after{content:attr(data-scope);font-family:Helvetica,Arial;line-height:11px;font-size:9px;font-weight:normal;padding:2px 5px;white-space:nowrap;max-height:16px;color:#000;text-align:center;background-color:var(--data-reactive-color);position:absolute;bottom:-15px;left:-1px;border-bottom-right-radius:.2rem;border-bottom-left-radius:.2rem}"])),
g("highlightActionData")&&g("highlightVisibilityData")&&(a=a.concat(["[data-content][data-visibility]:not([data-effect])::before{content: attr(data-content) ' "+g("visibilitySymbol")+" ' attr(data-visibility)}","[data-effect][data-visibility]:not([data-content])::before{content: ' "+g("effectSymbol")+" ' attr(data-effect) ' "+g("visibilitySymbol")+" ' attr(data-visibility)}","[data-content][data-effect][data-visibility]::before{content: attr(data-content)  ' "+g("effectSymbol")+" ' attr(data-effect) ' "+
g("visibilitySymbol")+" ' attr(data-visibility)}"])),g("highlightVisibilityArea")&&(a=a.concat(["[data-visibility]:not([data-scope])::after {content:'';position: absolute;top: 0;left: 0;width: 100%;height: 100%;background-image:repeating-linear-gradient(45deg,transparent,transparent 10px,var(--data-reactive-color) 10px,var(--data-reactive-color) 20px);opacity: .1;}"])),a.forEach(d=>document.styleSheets[0].insertRule(d,0)))}):window.addEventListener("DOMContentLoaded",function(a){a=[];switch(g("visibilityMode")){case "auto":a.push('[data-visibility][style*\x3d"visibility: hidden"] [data-visibility] { visibility: hidden !important; }');
break;case "manual":a.push('[style*\x3d"visibility: hidden"] .inheritVisibility { visibility: hidden !important; }','.propagateVisibility[data-visibility][style*\x3d"visibility: hidden"] [data-visibility] { visibility: hidden !important; }')}a.forEach(d=>document.styleSheets[0].insertRule(d,0))});return{version:"1.5",setDefault:function(a,d){"object"==typeof a?u=a:u[a]=d},getDefault:g,enableReactiveObject:z,disableReactiveObject:D,debounceByRequestFrame:B}}());
