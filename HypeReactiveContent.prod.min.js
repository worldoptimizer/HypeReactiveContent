/*
 Hype Reactive Content 1.3.0
copyright (c) 2022 Max Ziebell, (https://maxziebell.de). MIT-license
*/
!1==="HypeReactiveContent"in window&&(window.HypeReactiveContent=function(){function p(a){return a?_default[a]:_default}function u(a,c){return a?a+"."+c:c}function v(a,c,d){d=d||"";return null==a||a[w]?a:new Proxy(a,{get:function(e,h,b){if("_key"===h)return d;if(h===w)return!0;e=Reflect.get(e,h,b);return"object"===typeof e?v(e,c,u(d,h)):e},set:function(e,h,b,f){var k=Reflect.set(e,h,b,f);c(h,b,e,f);return k}})}function z(a){if(!a[w])return a;var c={},d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];
c[d]="object"===typeof e?z(e):e}return c}function x(a){return function(){if(!a.timeout){var c=arguments;a.timeout=requestAnimationFrame(function(){a.apply(this,c);a.timeout=null}.bind(this))}}}function q(a,c,d,e){if(d){if("object"!==typeof d)return null}else{if(void 0===d)return null;d=c.customData}e=e||{};if(!1!=="HypeActionEvents"in window)return c.triggerAction(a,{element:e.element,event:{type:e.type},scope:d});try{var h=new Proxy(Object.assign({element:e.element,$elm:e.element},c),{set:function(b,
f,k,l){return Reflect.get(b,f,l)?Reflect.set(b,f,k,l):Reflect.set(d,f,k)},get:function(b,f,k){return(b=Reflect.get(b,f,k))?b:Reflect.get(d,f)},has:function(b,f,k){return b.hasOwnProperty(f)||window[f]?Reflect.has(b,f,k):!0}});return(new Function("$context","with($context){ "+a+"}"))(h)}catch(b){console.error(b)}}function A(a,c,d){return d?q("return "+d,a,null,{element:c,type:"HypeReactiveScope"}):null}function B(a,c){var d=c.closest("[data-scope]");return d?A(a,c,d.getAttribute("data-scope")):null}
function y(a,c,d){var e=p("scopeSymbol"),h=e.length,b=null;a=a.trim();a.startsWith(e)?(a=a.slice(h),b=B(c,d)):a.includes(e)&&(b=a.slice(0,a.indexOf(e)),b=A(c,d,b),a=a.slice(a.indexOf(e)+h));return{value:a,scope:b}}function C(a){t.set(a,a.customData||{});Object.defineProperty(a,"customData",{get:function(){return t.get(a)},set:function(c){c=v(c,a.refreshReactiveContentDebounced);t.set(a,c);p("debounceCustomDataUpdate")?a.refreshReactiveContentDebounced():a.refreshReactiveContent()}})}function D(a,
c,d){!1==="HypeActionEvents"in window&&(c=d.customBehaviorName,"#"!=c.charAt(0)&&/[;=()]/.test(c)&&q(c,a,a.customData))}var t=new WeakMap;_default={scopeSymbol:"\u21e2",visibilitySymbol:"\ud83d\udc41\ufe0f",effectSymbol:"\u26a1\ufe0f",debounceCustomDataUpdate:!0};var w=Symbol("isProxy");!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,c,d){function e(b,f,k,l,g){(l=b.closest("["+k+"-action]"))&&q(l.getAttribute(k+
"-action"),a,null,{element:b,type:f});if((l=b.closest("["+k+"-behavior]"))&&!h[l.id]){h[l.id]=!0;var g=l.getAttribute(k+"-behavior");x(function(){a.triggerCustomBehaviorNamed(g)})()}}var h={};a.refreshReactiveContent=function(b,f,k,l){void 0===b||void 0===f||/[;=()]/.test(f)||a.triggerCustomBehaviorNamed(u(l._key,b)+" equals "+("string"===typeof f?'"'+f+'"':f));void 0!==b&&(p("customDataUpdate")&&p("customDataUpdate")(b,f,k,l),a.customDataUpdate&&a.customDataUpdate(b,f,k,l),a.triggerCustomBehaviorNamed("customData was changed"),
a.triggerCustomBehaviorNamed(u(l._key,b)+" was updated"));f=document.getElementById(a.currentSceneId());h={};f.querySelectorAll("[data-visibility], [data-content], [data-effect]").forEach(function(g){var m=g.getAttribute("data-content"),n=g.getAttribute("data-visibility"),r=g.getAttribute("data-effect");n&&(n=y(n,a,g),n=q("return "+n.value,a,n.scope,{element:g,type:"HypeReactiveVisibility"}),"none"==g.style.display&&(g.style.display="block"),n=n?"visible":"hidden",n!==g.style.visibility&&(g.style.visibility=
n,b&&e(g,"HypeReactiveVisibiltyChanged","data-visibility-changed",!0,!0)));r&&(r=y(r,a,g),q(r.value,a,r.scope,{element:g,type:"HypeReactiveEffect"}));m&&(m=y(m,a,g),m=q("return "+m.value,a,m.scope,{element:g,type:"HypeReactiveContent"}),m=void 0!==m?m:"",m!==g.innerHTML&&(g.innerHTML=m,b&&e(g,"HypeReactiveContentChanged","data-content-changed",!0,!0)))});!1!=="HypeDataMagic"in window&&HypeDataMagic.getDefault("refreshOnCustomData")&&a.refresh()};a.refreshReactiveContentDebounced=x(a.refreshReactiveContent);
a.resolveClosestScope=function(b){return B(a,b)};a.enableReactiveCustomData=function(b){var f=t.get(a)||{};a.customData=Object.assign(f,b||{})};C(a);a.enableReactiveCustomData(p("customData")||{});a.functions().HypeReactiveContent&&a.functions().HypeReactiveContent(a,c,d)}});window.HYPE_eventListeners.push({type:"HypeScenePrepareForDisplay",callback:function(a,c,d){a.refreshReactiveContentDebounced()}});!1==="HypeActionEvents"in window&&window.HYPE_eventListeners.push({type:"HypeTriggerCustomBehavior",
callback:D});return{version:"1.3.0",setDefault:function(a,c){"object"==typeof a?_default=a:_default[a]=c},getDefault:p,enableReactiveObject:v,disableReactiveObject:z,debounceByRequestFrame:x}}());
